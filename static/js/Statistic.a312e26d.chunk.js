(this.webpackJsonpWallet=this.webpackJsonpWallet||[]).push([[5],{150:function(t,a,e){"use strict";e.r(a);var n=e(27),r=e(162),s=e(163),c=e(166),o=e(165),l=e(0),i=e.n(l),u=e(339),m=e(21),p=e(23),h=(e(51),e(22)),d=e.n(h),f=e(29),v=e(18),S=e.n(v);S.a.defaults.baseURL="https://sheltered-sea-54747.herokuapp.com";var E=function(t,a){return function(){var e=Object(f.a)(d.a.mark((function e(n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(p.a.transactionsSummaryRequest()),e.prev=1,e.next=4,S.a.get("/api/transactions-summary?month=".concat(a,"&year=").concat(t));case 4:return r=e.sent,n(p.a.transactionsSummarySuccess(r.data)),console.log(r.data),e.abrupt("return",r.data);case 10:e.prev=10,e.t0=e.catch(1),n(p.a.transactionsSummaryError(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()},y=function(){return function(){var t=Object(f.a)(d.a.mark((function t(a){var e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(p.a.allTransactionsRequest()),t.prev=1,t.next=4,S.a.get("/api/transactions");case 4:return e=t.sent,a(p.a.allTransactionsSuccess(e.data)),console.log(e.data),t.abrupt("return",e.data);case 10:t.prev=10,t.t0=t.catch(1),a(p.a.allTransactionsError(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(a){return t.apply(this,arguments)}}()},_=function(t){return t.statistics},b=function(t){return t.statistics.allTransactions},g=e(7),N=e(241),M=e.n(N),Y=e(26);M.a.locale("ru");var k=e(435),O=e.n(k);M.a.locale("ru");var C=function(t){Object(c.a)(e,t);var a=Object(o.a)(e);function e(){var t;Object(r.a)(this,e);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(t=a.call.apply(a,[this].concat(s))).state={valueMonth:0,valueYear:0,monthsInRequestedYear:[],arrayOfDates:[]},t.handleChange=function(a){a.preventDefault();var e=a.target,n=e.name,r=e.value,s=t.state,c=s.arrayOfDates;s.valueMonth,s.valueYear;if("valueYear"===n){t.setState({valueMonth:0});var o=c.find((function(t){return t.year===r}));t.setState({monthsInRequestedYear:o.month})}t.setState(Object(g.a)({},n,Number(r)))},t}return Object(s.a)(e,[{key:"componentDidMount",value:function(){this.props.onFetchAllTransactions()}},{key:"componentDidUpdate",value:function(t){var a=this.state,e=a.valueMonth,n=a.valueYear,r=this.props.allTransactions;if(r!==t.allTransactions){var s=function(t){for(var a=0;a<t.length;a+=1)for(var e=a+1;e<t.length;e+=1)t[a].year===t[e].year&&t[a].month!==t[e].month&&(t[e].year,t[a].month=Object(Y.a)(new Set([].concat(Object(Y.a)(t[a].month),Object(Y.a)(t[e].month)))).sort(),t.splice(e,1),e=a);return t}(r.filter((function(t){return"EXPENSE"===t.type})).map((function(t){var a=t.transactionDate;return{year:M()(a,"YYYY MM D").format("YYYY"),month:[M()(a,"YYYY MM D").format("MM")]}})).sort((function(t,a){return t.year-a.year})));this.setState({arrayOfDates:s})}0!==e&&0!==n&&this.props.onFetchSummaryTransactions(n,e)}},{key:"render",value:function(){var t=this.state,a=t.valueMonth,e=t.valueYear,n=t.arrayOfDates,r=t.monthsInRequestedYear;return i.a.createElement("form",{className:O.a.selectBlock},i.a.createElement("select",{className:O.a.selectWrapper,name:"valueMonth",onChange:this.handleChange},e?i.a.createElement("option",{className:O.a.optionYM,disabled:!!a},"\u041c\u0435\u0441\u044f\u0446"):i.a.createElement("option",{className:O.a.optionYM},'\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 "\u0433\u043e\u0434"'),r&&r.map((function(t){return i.a.createElement("option",{className:O.a.optionYM,key:t,value:t},M()(t,"MM").format("MMMM"))}))),i.a.createElement("select",{className:O.a.selectWrapper,name:"valueYear",onChange:this.handleChange},i.a.createElement("option",{className:O.a.optionYM,disabled:!!e},"\u0413\u043e\u0434"),n.map((function(t){var a=t.year;return i.a.createElement("option",{className:O.a.optionYM,key:a,value:a},a)}))))}}]),e}(l.Component),T=Object(m.b)((function(t){return{allTransactions:b(t)}}),(function(t){return{onFetchAllTransactions:function(){return t(y())},onFetchSummaryTransactions:function(a,e){return t(E(a,e))}}}))(C),D=["#FED057","#FFD8D0","#FD9498","#C5BAFF","#6E78E8","#4A56E2","#81E1FF","#24CCA7","#00AD84"],x=e(436),j=e.n(x),F=function(t){Object(c.a)(e,t);var a=Object(o.a)(e);function e(){var t;Object(r.a)(this,e);for(var s=arguments.length,c=new Array(s),o=0;o<s;o++)c[o]=arguments[o];return(t=a.call.apply(a,[this].concat(c))).state={categoriesExpenseWithColors:[]},t.categoriesExpense=function(t){return t.filter((function(t){return"EXPENSE"===t.type}))},t.categoriesExpenseWithColors=function(t){return t.map((function(t,a){return{categoryWithColor:Object(n.a)(Object(n.a)({},t),{},{color:D[a]})}}))},t}return Object(s.a)(e,[{key:"componentDidUpdate",value:function(t){var a=this.props.statistics,e=this.props.statistics.transactionsSummary.categoriesSummary,n=this.categoriesExpense,r=this.categoriesExpenseWithColors;if(a!==t.statistics&&void 0!==e){var s=r(n(e));this.setState({categoriesExpenseWithColors:s})}}},{key:"render",value:function(){var t=this.state.categoriesExpenseWithColors,a=this.props.statistics.transactionsSummary,e=a.incomeSummary,n=a.expenseSummary,r=a.periodTotal;u.defaults.global.legend.display=!1,u.defaults.global.legend.position="right";var s={labels:t.map((function(t){return t.categoryWithColor.name})),datasets:[{data:t.map((function(t){var a=t.categoryWithColor;return Math.abs(a.total).toFixed(2)})),backgroundColor:D}]};return i.a.createElement("div",{className:j.a.statisticsBlock},i.a.createElement("div",{className:j.a.doughnut},i.a.createElement("div",{className:j.a.statHeader},"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"),r&&i.a.createElement("div",{className:j.a.periodTotal},"\u20b4 ",r.toFixed(2)),i.a.createElement(u.Doughnut,{data:s,width:320,height:320,options:{elements:{arc:{borderWidth:0}},cutoutPercentage:75}})),i.a.createElement("div",{className:j.a.stat},i.a.createElement(T,null),i.a.createElement("table",{className:j.a.statTable},i.a.createElement("thead",{className:j.a.theadStat},i.a.createElement("tr",{className:j.a.trStat},i.a.createElement("th",{className:j.a.thStat},"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),i.a.createElement("th",{className:j.a.thStat},"\u0421\u0443\u043c\u043c\u0430"))),a&&void 0!==e&&i.a.createElement("tbody",{className:j.a.tbodyStat},t.map((function(t){var a=t.categoryWithColor;return i.a.createElement("tr",{className:j.a.trStat,key:a.name},i.a.createElement("td",{className:j.a.tdStat},i.a.createElement("div",{className:j.a.nameBlock},i.a.createElement("div",{className:j.a.color,style:{backgroundColor:a.color}}),i.a.createElement("div",null,a.name))),i.a.createElement("td",{className:j.a.tdStat},Math.abs(a.total).toFixed(2)))})),i.a.createElement("tr",{className:j.a.trStat},i.a.createElement("td",{className:j.a.tdStat},"\u0420\u0430\u0441\u0445\u043e\u0434\u044b:"),i.a.createElement("td",{className:j.a.tdStat},Math.abs(n).toFixed(2))),i.a.createElement("tr",{className:j.a.trStat},i.a.createElement("td",{className:j.a.tdStat},"\u0414\u043e\u0445\u043e\u0434\u044b:"),i.a.createElement("td",{className:j.a.tdStat},e.toFixed(2)))))))}}]),e}(l.Component);a.default=Object(m.b)((function(t){return{statistics:_(t)}}))(F)},435:function(t,a,e){t.exports={selectBlock:"Select_selectBlock__2q6Rn",selectWrapper:"Select_selectWrapper__2AKdg",optionYM:"Select_optionYM__3w0Ok"}},436:function(t,a,e){t.exports={statisticsBlock:"Statistics_statisticsBlock__3Dn3Y",statHeader:"Statistics_statHeader__1qTfw",periodTotal:"Statistics_periodTotal__1_TTO",stat:"Statistics_stat__3Y__y",statTable:"Statistics_statTable__2CKJi",theadStat:"Statistics_theadStat__1sQIB",thStat:"Statistics_thStat__1a1ul",tbodyStat:"Statistics_tbodyStat__3Hntt",trStat:"Statistics_trStat__XDzlM",tdStat:"Statistics_tdStat__1frKM",nameBlock:"Statistics_nameBlock__zJnDa",color:"Statistics_color__lUQ2l",doughnut:"Statistics_doughnut__29-Z8"}}}]);
//# sourceMappingURL=Statistic.a312e26d.chunk.js.map